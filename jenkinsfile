pipeline {
    agent { 
        node {
            label 'Node1'
        }
    }
    stages {
        // stage('Setup Nginx Ingress') {
        //     steps{
        //         sh '''
        //         kubectl create ns ingress-nginx
        //         kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.3.0/deploy/static/provider/cloud/deploy.yaml
        //         '''
        //     }
        // }
        stage('Execute Ansible Playbook') {
            steps {
                echo 'Running playbook.......'
                ansiblePlaybook (
                    credentialsId: '53bcae05-a087-4903-ba8b-d324766d3660',
                    disableHostKeyChecking: true,
                    installation: 'Ansible',
                    inventory: 'Ansible/inventory.k8s.yml',
                    playbook: 'Ansible/playbook.yml',
                    colorized: true
                )
            }
        }
    }
}
